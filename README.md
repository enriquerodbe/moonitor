# ${1:Moonitor}
Moonitor is a monitoring tool that collects information from a list of 
configured hosts and saves this information in a time series database.

It's designed on top of the Akka framework. As such, it's 
modeled as actors and message passing between them.

Its fundamental architecture is based on agents and principals. Agents are 
installed on the target machines to be monitored. Principals tell agents what 
information to collect and how often. Then, agents start collecting and 
sending the information to their respective principals. Finally, principals
save the information to the database.

Technology stack:
Principals, agents and other auxiliar actors are written in Scala.
To collect machine metrics, the Sigar library is used.
Agents configuration (where and what to collect) is saved in a Redis instance.
Metric values are stored into an InfluxDB database.
Optionally, a Grafana server can be added to visualize graphics from InfluxDb 
data.

Other technologies involved:
Spray for the REST services.
Jackson for JSON serialization.
Typesafe config for environmental configurations.
Courier for sending email notifications.
Scalaj for http communication with InfluxDb.
SBT as the building tool.
sbt-native-packager to easily create installation packages.

## Building and running
If you just want to run a single instance from sbt, execute `run` from the
specific subproject you want to run.
For example:
```
$ sbt
> project agent
> run
```

On the other hand, if you want to test the scripts generated by 
sbt-package-manager, you can execute `stage` from a subproject. Then you can 
call the script directly.
For instance:
```
$ sbt "project agent" stage
$ ./agent/target/universal/stage/bin/moonitor-agent
```

## Installation
In order to install the agent or the principal as OS services, an easy way is 
to use sbt-native-packager with the `JavaServerAppPackaging` plugin. To do 
this, just run `rpm:packageBin` or `debian:packageBin`, depending on the 
target platform.
If you chose rpm, then the target .rpm file will be:
agent/target/rpm/RPMS/x86_64/moonitor-agent-0.1-1.x86_64.rpm
And you can install it with the following command:
$ sudo rpm -i moonitor-agent-0.1-1.x86_64.rpm

If you chose debian, the .deb file will be:
agent/target/moonitor-agent_0.1_all.deb
To install it in a debian system:
sudo dpkg -i moonitor-agent_0.1_all.deb

The installation of these packages will create the corresponding file 
structure (see  documentation), and add it as a system service. You cant start 
and stop the service by issuing `sudo service moonitor-agent start` and 
`sudo service moonitor-agent stop` respectively.

## License
See the LICENSE file for license rights and limitations.
